{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "84f7a0dd",
   "metadata": {},
   "source": [
    "You have a DataFrame called schedules that represents the daily schedule of each student in a school. For example, If Ryan attends four classes - math, english, history, and chemistry, your schedules DataFrame will have four rows for Ryan in the order he attends each class.\n",
    "\n",
    "You have this theory that the sequence of class-to-class transitions affects students' grades. For instance, you suspect Ryan would do better in his Chemistry class if it immediately followed his Math class instead of his History class.\n",
    "\n",
    "Determine the average and median Chemistry grade for groups of students based on the class they have immediately prior to Chemistry. Also report how many students fall into each group."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "id": "920b0223",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     student_id        class  grade\n",
      "0             0  engineering     86\n",
      "1             0    chemistry     75\n",
      "2             1         math     85\n",
      "3             1  engineering      0\n",
      "4             1      english     73\n",
      "..          ...          ...    ...\n",
      "334          98      writing     16\n",
      "335          98       civics     89\n",
      "336          99  engineering     90\n",
      "337          99         math     55\n",
      "338          99      history     31\n",
      "\n",
      "[339 rows x 3 columns]\n"
     ]
    }
   ],
   "source": [
    "\n",
    "\n",
    "\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "generator = np.random.default_rng(seed=1234)\n",
    "classes = ['english', 'math', 'history', 'chemistry', 'gym', 'civics', 'writing', 'engineering']\n",
    "\n",
    "schedules = pd.DataFrame({\n",
    "    'student_id':np.repeat(np.arange(100), 4),\n",
    "    'class':generator.choice(classes, size=400, replace=True)\n",
    "}).drop_duplicates(ignore_index=True)\n",
    "schedules['grade'] = generator.integers(101, size=schedules.shape[0])\n",
    "\n",
    "print(schedules)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "id": "07af3627",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "37"
      ]
     },
     "execution_count": 70,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "temp = schedules[(schedules['class']=='chemistry')].index\n",
    "len(temp)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "id": "c9579740",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>student_id</th>\n",
       "      <th>class</th>\n",
       "      <th>grade</th>\n",
       "      <th>previous_1</th>\n",
       "      <th>previous_2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>engineering</td>\n",
       "      <td>86</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>75</td>\n",
       "      <td>engineering</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>math</td>\n",
       "      <td>85</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>engineering</td>\n",
       "      <td>0</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>english</td>\n",
       "      <td>73</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>1</td>\n",
       "      <td>history</td>\n",
       "      <td>81</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2</td>\n",
       "      <td>math</td>\n",
       "      <td>12</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2</td>\n",
       "      <td>history</td>\n",
       "      <td>81</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2</td>\n",
       "      <td>gym</td>\n",
       "      <td>79</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2</td>\n",
       "      <td>english</td>\n",
       "      <td>5</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>3</td>\n",
       "      <td>writing</td>\n",
       "      <td>93</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>3</td>\n",
       "      <td>math</td>\n",
       "      <td>9</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>3</td>\n",
       "      <td>history</td>\n",
       "      <td>56</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>4</td>\n",
       "      <td>writing</td>\n",
       "      <td>55</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>4</td>\n",
       "      <td>engineering</td>\n",
       "      <td>86</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>4</td>\n",
       "      <td>history</td>\n",
       "      <td>77</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>5</td>\n",
       "      <td>gym</td>\n",
       "      <td>45</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>5</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>73</td>\n",
       "      <td>gym</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>5</td>\n",
       "      <td>history</td>\n",
       "      <td>16</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>6</td>\n",
       "      <td>engineering</td>\n",
       "      <td>68</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>6</td>\n",
       "      <td>writing</td>\n",
       "      <td>68</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>6</td>\n",
       "      <td>civics</td>\n",
       "      <td>77</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>7</td>\n",
       "      <td>gym</td>\n",
       "      <td>84</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>7</td>\n",
       "      <td>civics</td>\n",
       "      <td>60</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>7</td>\n",
       "      <td>engineering</td>\n",
       "      <td>66</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>8</td>\n",
       "      <td>english</td>\n",
       "      <td>23</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>8</td>\n",
       "      <td>civics</td>\n",
       "      <td>63</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>8</td>\n",
       "      <td>math</td>\n",
       "      <td>2</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>9</td>\n",
       "      <td>writing</td>\n",
       "      <td>8</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>9</td>\n",
       "      <td>math</td>\n",
       "      <td>92</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>10</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>23</td>\n",
       "      <td>nothing</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>10</td>\n",
       "      <td>english</td>\n",
       "      <td>41</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>10</td>\n",
       "      <td>math</td>\n",
       "      <td>46</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>10</td>\n",
       "      <td>civics</td>\n",
       "      <td>73</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>11</td>\n",
       "      <td>english</td>\n",
       "      <td>55</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>11</td>\n",
       "      <td>civics</td>\n",
       "      <td>26</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>36</th>\n",
       "      <td>11</td>\n",
       "      <td>math</td>\n",
       "      <td>27</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>11</td>\n",
       "      <td>gym</td>\n",
       "      <td>99</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38</th>\n",
       "      <td>12</td>\n",
       "      <td>gym</td>\n",
       "      <td>20</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>12</td>\n",
       "      <td>english</td>\n",
       "      <td>17</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    student_id        class  grade   previous_1  previous_2\n",
       "0            0  engineering     86                       -1\n",
       "1            0    chemistry     75  engineering           0\n",
       "2            1         math     85                       -1\n",
       "3            1  engineering      0                       -1\n",
       "4            1      english     73                       -1\n",
       "5            1      history     81                       -1\n",
       "6            2         math     12                       -1\n",
       "7            2      history     81                       -1\n",
       "8            2          gym     79                       -1\n",
       "9            2      english      5                       -1\n",
       "10           3      writing     93                       -1\n",
       "11           3         math      9                       -1\n",
       "12           3      history     56                       -1\n",
       "13           4      writing     55                       -1\n",
       "14           4  engineering     86                       -1\n",
       "15           4      history     77                       -1\n",
       "16           5          gym     45                       -1\n",
       "17           5    chemistry     73          gym           5\n",
       "18           5      history     16                       -1\n",
       "19           6  engineering     68                       -1\n",
       "20           6      writing     68                       -1\n",
       "21           6       civics     77                       -1\n",
       "22           7          gym     84                       -1\n",
       "23           7       civics     60                       -1\n",
       "24           7  engineering     66                       -1\n",
       "25           8      english     23                       -1\n",
       "26           8       civics     63                       -1\n",
       "27           8         math      2                       -1\n",
       "28           9      writing      8                       -1\n",
       "29           9         math     92                       -1\n",
       "30          10    chemistry     23      nothing           9\n",
       "31          10      english     41                       -1\n",
       "32          10         math     46                       -1\n",
       "33          10       civics     73                       -1\n",
       "34          11      english     55                       -1\n",
       "35          11       civics     26                       -1\n",
       "36          11         math     27                       -1\n",
       "37          11          gym     99                       -1\n",
       "38          12          gym     20                       -1\n",
       "39          12      english     17                       -1"
      ]
     },
     "execution_count": 72,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "schedules['previous_1']=''\n",
    "temp1 = schedules.loc[temp-1,'class'].copy().values\n",
    "schedules.loc[temp,'previous_1'] = temp1\n",
    "schedules['previous_2']=-1\n",
    "temp1 = schedules.loc[temp-1,'student_id'].copy().values\n",
    "schedules.loc[temp,'previous_2'] = temp1\n",
    "tt = schedules.query('student_id!=previous_2 & previous_2!=-1').index\n",
    "schedules.loc[schedules.query('student_id!=previous_2 & previous_2!=-1').index,'previous_1']='nothing'\n",
    "schedules.head(40)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "id": "00f18be5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>student_id</th>\n",
       "      <th>class</th>\n",
       "      <th>grade</th>\n",
       "      <th>previous_1</th>\n",
       "      <th>previous_2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>75</td>\n",
       "      <td>engineering</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>5</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>73</td>\n",
       "      <td>gym</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>10</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>23</td>\n",
       "      <td>nothing</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42</th>\n",
       "      <td>13</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>68</td>\n",
       "      <td>nothing</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50</th>\n",
       "      <td>15</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>64</td>\n",
       "      <td>writing</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>63</th>\n",
       "      <td>19</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>39</td>\n",
       "      <td>english</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>64</th>\n",
       "      <td>20</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>42</td>\n",
       "      <td>nothing</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>72</th>\n",
       "      <td>22</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>46</td>\n",
       "      <td>writing</td>\n",
       "      <td>22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75</th>\n",
       "      <td>23</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>14</td>\n",
       "      <td>history</td>\n",
       "      <td>23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>84</th>\n",
       "      <td>26</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>23</td>\n",
       "      <td>math</td>\n",
       "      <td>26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>92</th>\n",
       "      <td>28</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>65</td>\n",
       "      <td>history</td>\n",
       "      <td>28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>106</th>\n",
       "      <td>32</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>22</td>\n",
       "      <td>english</td>\n",
       "      <td>32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112</th>\n",
       "      <td>34</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>24</td>\n",
       "      <td>english</td>\n",
       "      <td>34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>121</th>\n",
       "      <td>36</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>4</td>\n",
       "      <td>math</td>\n",
       "      <td>36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>134</th>\n",
       "      <td>40</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>73</td>\n",
       "      <td>nothing</td>\n",
       "      <td>39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>141</th>\n",
       "      <td>42</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>83</td>\n",
       "      <td>nothing</td>\n",
       "      <td>41</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>147</th>\n",
       "      <td>43</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>45</td>\n",
       "      <td>english</td>\n",
       "      <td>43</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>154</th>\n",
       "      <td>45</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>64</td>\n",
       "      <td>gym</td>\n",
       "      <td>45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>158</th>\n",
       "      <td>47</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>93</td>\n",
       "      <td>nothing</td>\n",
       "      <td>46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>166</th>\n",
       "      <td>49</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>53</td>\n",
       "      <td>engineering</td>\n",
       "      <td>49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>173</th>\n",
       "      <td>51</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>27</td>\n",
       "      <td>history</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>175</th>\n",
       "      <td>52</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>62</td>\n",
       "      <td>nothing</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>180</th>\n",
       "      <td>54</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>94</td>\n",
       "      <td>nothing</td>\n",
       "      <td>53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>195</th>\n",
       "      <td>58</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>45</td>\n",
       "      <td>civics</td>\n",
       "      <td>58</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>200</th>\n",
       "      <td>59</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>51</td>\n",
       "      <td>math</td>\n",
       "      <td>59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>212</th>\n",
       "      <td>63</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>28</td>\n",
       "      <td>nothing</td>\n",
       "      <td>62</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>217</th>\n",
       "      <td>64</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>65</td>\n",
       "      <td>civics</td>\n",
       "      <td>64</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>231</th>\n",
       "      <td>68</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>78</td>\n",
       "      <td>engineering</td>\n",
       "      <td>68</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>254</th>\n",
       "      <td>75</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>55</td>\n",
       "      <td>nothing</td>\n",
       "      <td>74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>270</th>\n",
       "      <td>79</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>45</td>\n",
       "      <td>english</td>\n",
       "      <td>79</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>277</th>\n",
       "      <td>81</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>2</td>\n",
       "      <td>engineering</td>\n",
       "      <td>81</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>287</th>\n",
       "      <td>84</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>18</td>\n",
       "      <td>engineering</td>\n",
       "      <td>84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>290</th>\n",
       "      <td>85</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>21</td>\n",
       "      <td>english</td>\n",
       "      <td>85</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>298</th>\n",
       "      <td>88</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>86</td>\n",
       "      <td>nothing</td>\n",
       "      <td>87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>304</th>\n",
       "      <td>90</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>58</td>\n",
       "      <td>nothing</td>\n",
       "      <td>89</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>315</th>\n",
       "      <td>93</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>34</td>\n",
       "      <td>engineering</td>\n",
       "      <td>93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>322</th>\n",
       "      <td>95</td>\n",
       "      <td>chemistry</td>\n",
       "      <td>26</td>\n",
       "      <td>writing</td>\n",
       "      <td>95</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     student_id      class  grade   previous_1  previous_2\n",
       "1             0  chemistry     75  engineering           0\n",
       "17            5  chemistry     73          gym           5\n",
       "30           10  chemistry     23      nothing           9\n",
       "42           13  chemistry     68      nothing          12\n",
       "50           15  chemistry     64      writing          15\n",
       "63           19  chemistry     39      english          19\n",
       "64           20  chemistry     42      nothing          19\n",
       "72           22  chemistry     46      writing          22\n",
       "75           23  chemistry     14      history          23\n",
       "84           26  chemistry     23         math          26\n",
       "92           28  chemistry     65      history          28\n",
       "106          32  chemistry     22      english          32\n",
       "112          34  chemistry     24      english          34\n",
       "121          36  chemistry      4         math          36\n",
       "134          40  chemistry     73      nothing          39\n",
       "141          42  chemistry     83      nothing          41\n",
       "147          43  chemistry     45      english          43\n",
       "154          45  chemistry     64          gym          45\n",
       "158          47  chemistry     93      nothing          46\n",
       "166          49  chemistry     53  engineering          49\n",
       "173          51  chemistry     27      history          51\n",
       "175          52  chemistry     62      nothing          51\n",
       "180          54  chemistry     94      nothing          53\n",
       "195          58  chemistry     45       civics          58\n",
       "200          59  chemistry     51         math          59\n",
       "212          63  chemistry     28      nothing          62\n",
       "217          64  chemistry     65       civics          64\n",
       "231          68  chemistry     78  engineering          68\n",
       "254          75  chemistry     55      nothing          74\n",
       "270          79  chemistry     45      english          79\n",
       "277          81  chemistry      2  engineering          81\n",
       "287          84  chemistry     18  engineering          84\n",
       "290          85  chemistry     21      english          85\n",
       "298          88  chemistry     86      nothing          87\n",
       "304          90  chemistry     58      nothing          89\n",
       "315          93  chemistry     34  engineering          93\n",
       "322          95  chemistry     26      writing          95"
      ]
     },
     "execution_count": 73,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data = schedules.loc[schedules['class']=='chemistry']\n",
    "data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "id": "77a518c3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>mean</th>\n",
       "      <th>median</th>\n",
       "      <th>count</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>previous_1</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>civics</th>\n",
       "      <td>55.000000</td>\n",
       "      <td>55.0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>engineering</th>\n",
       "      <td>43.333333</td>\n",
       "      <td>43.5</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>english</th>\n",
       "      <td>32.666667</td>\n",
       "      <td>31.5</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>gym</th>\n",
       "      <td>68.500000</td>\n",
       "      <td>68.5</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>history</th>\n",
       "      <td>35.333333</td>\n",
       "      <td>27.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>math</th>\n",
       "      <td>26.000000</td>\n",
       "      <td>23.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>nothing</th>\n",
       "      <td>63.750000</td>\n",
       "      <td>65.0</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>writing</th>\n",
       "      <td>45.333333</td>\n",
       "      <td>46.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                  mean  median  count\n",
       "previous_1                           \n",
       "civics       55.000000    55.0      2\n",
       "engineering  43.333333    43.5      6\n",
       "english      32.666667    31.5      6\n",
       "gym          68.500000    68.5      2\n",
       "history      35.333333    27.0      3\n",
       "math         26.000000    23.0      3\n",
       "nothing      63.750000    65.0     12\n",
       "writing      45.333333    46.0      3"
      ]
     },
     "execution_count": 76,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.groupby('previous_1')['grade'].agg(['mean','median','count'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3fb97ea4",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
